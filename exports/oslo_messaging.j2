{% macro rabbit(cfg_type) -%}
{% if cfg_type == 'rpc_config' -%}
  [DEFAULT]
{%- elif cfg_type == 'notifications_config' -%}
  [oslo_messaging_notifications]
{%- endif %}
transport_url=rabbit://{{ rabbitmq.user }}:{{ rabbitmq.password }}@{{ address('rabbitmq', rabbitmq.port) }}

{%- endmacro %}

{% macro rabbit_tls() -%}
{% if rabbitmq.tls.enabled -%}
[oslo_messaging_rabbit]
kombu_ssl_version="TLSv1_2"
rabbit_use_ssl = true
kombu_ssl_ca_certs = /opt/ccp/etc/tls/ca.pem
{% endif %}

{%- endmacro %}
